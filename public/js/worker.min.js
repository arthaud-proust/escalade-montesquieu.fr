function isClientFocused(){return clients.matchAll({type:"window",includeUncontrolled:!0}).then(t=>{let e=!1;for(let n=0;n<t.length;n++){if(t[n].focused){e=!0;break}}return e})}console.log("Service Worker Loaded..."),self.addEventListener("push",t=>{const e=t.data.json();self.registration.getNotifications().then(function(t){t.filter(t=>t.data.forum==e.forum).forEach(t=>t.close());isClientFocused().then(t=>{});self.registration.showNotification(`${e.author} - ${e.forum.charAt(0).toUpperCase()+e.forum.slice(1).replace(/-/g," ")}`,{body:e.content,tag:`${e.forum}.${e.id}`,icon:"https://escalade-montesquieu.fr/assets/img/apple/apple-touch-icon-180x180.png",badge:"https://escalade-montesquieu.fr/assets/img/favicon.ico",vibrate:[200,100,200,100,200,100,200],data:{url:e.url,forum:e.forum,author:e.author}})})}),self.addEventListener("fetch",t=>{console.log(t)}),self.addEventListener("activate",function(t){console.log("SW Activate ")}),self.addEventListener("install",function(t){console.log("SW Install ")}),self.onnotificationclick=function(t){t.notification.close(),t.waitUntil(clients.matchAll({type:"window"}).then(function(e){for(var n=0;n<e.length;n++){var o=e[n];if(o.url==t.notification.url&&"focus"in o)return o.focus()}if(clients.openWindow)return clients.openWindow(t.notification.data.url)}))};
